import{R as C,u as j,r as c,j as e,d as h,A as R,U as I,T as f}from"./index-DEemqsSM.js";import{u as k,i as D,g as A,f as L}from"./useCardExpansion-CPBgE9c9.js";const v=s=>{const t=/#\w+/g,a=s.match(t);return a?a.map(o=>o.toLowerCase()):[]},O=s=>v(s).some(a=>a==="#rad"),M=s=>{const t=v(s),a=t.findIndex(o=>o==="#rad");return a===-1?[]:t.slice(a+1)},_=s=>s.replace(/#\w+/g,"").trim().replace(/\s+/g," "),P=s=>{if(!O(s))return null;const t=M(s);return{type:"radiology",content:_(s),tags:v(s),subtags:t,icon:"üè•",description:t.length>0?`Radiology note with tags: ${t.join(", ")}`:"Radiology note"}};function w(s){const t=s.trim();if(t.endsWith("'"))return{type:"investment",content:t.slice(0,-1).trim(),icon:"üí∞",description:"Ìà¨ÏûêÎ°ú Ï†ÄÏû•",statusMessage:"ÎÇ¥ Ìà¨ÏûêÏóê Ï†ÄÏû•Îê©ÎãàÎã§"};const a=P(t);if(a)return{...a,statusMessage:"ÏòÅÏÉÅÏùòÌïôÏóê Ï†ÄÏû•Îê©ÎãàÎã§"};if(t.endsWith(";")){let o=t.slice(0,-1).trim(),d;const u=/\s@(.+)$/,g=o.match(u);if(g&&g[1]){const r=g[1],x=new Date(r);isNaN(x.getTime())||(d=x,o=o.replace(u,"").trim())}return{type:"todo",content:o,icon:"‚úÖ",description:d?`Ìï† ÏùºÎ°ú Ï†ÄÏû• (ÎßàÍ∞êÏùº: ${d.toLocaleDateString()})`:"Ìï† ÏùºÎ°ú Ï†ÄÏû• + Ï∫òÎ¶∞Îçî Îì±Î°ù",dueDate:d,statusMessage:"ÎÇ¥ Ìï† ÏùºÏóê Ï†ÄÏû•Îê©ÎãàÎã§"}}return{type:"thought",content:t,icon:"üí≠",description:"ÎÇ¥ ÏÉùÍ∞ÅÏúºÎ°ú Ï†ÄÏû•",statusMessage:"ÎÇ¥ ÏÉùÍ∞ÅÏóê Ï†ÄÏû•Îê©ÎãàÎã§"}}const q=C.memo(()=>{const{t:s}=j(),[t,a]=c.useState(""),[o,d]=c.useState(null),[u,g]=c.useState(!1),r=c.useRef(null);c.useEffect(()=>{r.current&&r.current.focus()},[]),c.useEffect(()=>{t.trim()?d(w(t)):d(null)},[t]);const x=async l=>{if(l){if(l.key==="Enter"&&l.shiftKey)return;if(l.key==="Enter"&&!l.shiftKey)l.preventDefault();else if(l.key!=="Enter")return}if(!(!t.trim()||u)){g(!0);try{const i=w(t);i.type==="todo"?await h.addTodo(i.content,i.dueDate):i.type==="radiology"?await h.addRadiologyNote(i.content,i.tags||[]):i.type==="investment"?await h.addInvestment(i.content):await h.addThought(i.content),a(""),d(null),requestAnimationFrame(()=>{r.current&&(r.current.focus(),r.current.setSelectionRange(0,0))})}catch(i){console.error("Failed to save entry:",i)}finally{g(!1)}}},T=async()=>{await x(),requestAnimationFrame(()=>{r.current&&r.current.focus()})},N=c.useCallback(l=>{a(l.target.value)},[]);return e.jsx("div",{className:"px-0 sm:px-0 mb-6 sm:mb-8",children:e.jsx("div",{className:"bg-primary rounded-xl sm:rounded-3xl p-3 sm:p-8 shadow-lg border border-transparent mx-2 sm:mx-0",children:e.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[e.jsx("div",{children:e.jsx("h2",{className:"text-2xl sm:text-3xl font-bold mb-4 sm:mb-6 tracking-tight text-white",children:s("quick.title")})}),e.jsxs("div",{className:"relative",children:[e.jsx("textarea",{ref:r,value:t,onChange:N,onKeyDown:x,placeholder:s("quick.placeholder"),className:"w-full min-h-[100px] sm:min-h-[120px] p-4 text-base sm:text-xl border border-transparent bg-gray-100 text-gray-800 rounded-xl focus:outline-none focus:ring-2 focus:ring-primary resize-none placeholder-gray-500 font-normal leading-relaxed",disabled:u,rows:3}),e.jsx("button",{onClick:T,disabled:!t.trim()||u,className:"absolute bottom-2 right-2 sm:bottom-3 sm:right-3 w-10 h-10 sm:w-12 sm:h-12 text-white rounded-lg transition-all duration-200 flex items-center justify-center shadow-md hover:shadow-lg submit-button-green",children:u?e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}):e.jsx("svg",{className:"w-5 h-5 sm:w-6 sm:h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 19l9 2-9-18-9 18 9-2zm0 0v-8"})})})]}),o&&e.jsxs("div",{className:"text-left text-sm sm:text-base text-white/80 bg-white/10 px-3 py-2 rounded-lg",children:[e.jsx("span",{className:"text-lg mr-2",children:o.icon}),o.statusMessage]})]})})})}),B=()=>{const{t:s}=j(),{toggleCardExpansion:t,isExpanded:a}=k(),[o,d]=c.useState([]),[u,g]=c.useState([]),[r,x]=c.useState([]),[T,N]=c.useState([]);c.useEffect(()=>{const n=h.subscribeToThoughts(d),p=h.subscribeToTodos(g),y=h.subscribeToRadiologyNotes(x),b=h.subscribeToInvestments(N);return()=>{n(),p(),y(),b()}},[]);const l=c.useMemo(()=>{const n=o.map(m=>({...m,entryType:"thought"})),p=u.map(m=>({...m,entryType:"todo"})),y=r.map(m=>({...m,entryType:"radiology"})),b=T.map(m=>({...m,entryType:"investment"}));return[...n,...p,...y,...b].sort((m,S)=>new Date(S.createdAt).getTime()-new Date(m.createdAt).getTime()).slice(0,R.RECENT_ENTRIES_LIMIT)},[o,u,r,T]),i=n=>{switch(n.entryType){case"todo":return n.isCompleted?f.TODO_COMPLETED:f.TODO_PENDING;case"thought":return f.THOUGHT;case"radiology":return f.RADIOLOGY;case"investment":return f.INVESTMENT;default:return f.DEFAULT}},E=n=>{switch(n.entryType){case"todo":return s("type.todo");case"thought":return s("type.thought");case"radiology":return s("type.radiology");case"investment":return s("type.investment");default:return""}};return e.jsxs("div",{className:"max-w-7xl mx-auto px-0 sm:px-8 py-4 sm:py-8",children:[e.jsx(q,{}),l.length>0&&e.jsxs("div",{className:"px-4 sm:px-0",children:[e.jsxs("div",{className:"mb-6 sm:mb-8",children:[e.jsx("h3",{className:"text-xl sm:text-2xl font-bold text-gray-900 mb-2 tracking-tight",children:s("quick.recent")}),e.jsx("p",{className:"text-gray-500 text-base sm:text-lg font-medium",children:s("quick.recent_subtitle")})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-4 sm:gap-6",children:l.map(n=>{const p=D(n.content),y=a(n.id),b=p&&!y?A(n.content):n.content;return e.jsx("div",{className:"card card-hover",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"badge",children:[i(n)," ",E(n)]}),e.jsx("span",{className:"badge",children:L(n.createdAt)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-base leading-relaxed text-primary font-medium whitespace-pre-line",children:b}),p&&e.jsx("button",{onClick:()=>t(n.id),className:I.EXPAND_BUTTON_CLASSES,children:y?"Ï†ëÍ∏∞":"...ÎçîÎ≥¥Í∏∞"})]})]})},n.id)})})]})]})};export{B as QuickPage};
