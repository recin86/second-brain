import{R as L,u as k,r as s,j as e,d as n,A as _,U as M,T as x}from"./index-DlL53pBI.js";import{c as S,u as P,i as q,g as F,f as U,C as B}from"./CategoryChangeModal-BZYjauhF.js";const G=L.memo(()=>{const{t:i}=k(),[c,b]=s.useState(""),[h,p]=s.useState(null),[m,T]=s.useState(!1),o=s.useRef(null);s.useEffect(()=>{o.current&&o.current.focus()},[]),s.useEffect(()=>{c.trim()?p(S(c)):p(null)},[c]);const v=async r=>{if(r){if(r.key==="Enter"&&r.shiftKey)return;if(r.key==="Enter"&&!r.shiftKey)r.preventDefault();else if(r.key!=="Enter")return}if(!(!c.trim()||m)){T(!0);try{const a=S(c);a.type==="todo"?await n.addTodo(a.content,a.dueDate):a.type==="radiology"?await n.addRadiologyNote(a.content,a.tags||[]):a.type==="investment"?await n.addInvestment(a.content):await n.addThought(a.content),b(""),p(null),requestAnimationFrame(()=>{o.current&&(o.current.focus(),o.current.setSelectionRange(0,0))})}catch(a){console.error("Failed to save entry:",a)}finally{T(!1)}}},N=async()=>{await v(),requestAnimationFrame(()=>{o.current&&o.current.focus()})},w=s.useCallback(r=>{b(r.target.value)},[]);return e.jsx("div",{className:"px-0 sm:px-0 mb-6 sm:mb-8",children:e.jsx("div",{className:"bg-primary rounded-xl sm:rounded-3xl p-3 sm:p-8 shadow-lg border border-transparent mx-0 sm:mx-0",children:e.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[e.jsx("div",{children:e.jsx("h2",{className:"text-2xl sm:text-3xl font-bold mb-4 sm:mb-6 tracking-tight text-white",children:i("quick.title")})}),e.jsxs("div",{className:"relative",children:[e.jsx("textarea",{ref:o,value:c,onChange:w,onKeyDown:v,placeholder:i("quick.placeholder"),className:"w-full min-h-[100px] sm:min-h-[120px] p-4 text-base sm:text-xl border border-transparent bg-gray-100 text-gray-800 rounded-xl focus:outline-none focus:ring-2 focus:ring-primary resize-none placeholder-gray-500 placeholder:text-sm font-normal leading-relaxed",disabled:m,rows:3}),e.jsx("button",{onClick:N,disabled:!c.trim()||m,className:"absolute bottom-2 right-2 sm:bottom-3 sm:right-3 w-10 h-10 sm:w-12 sm:h-12 text-white rounded-lg transition-all duration-200 flex items-center justify-center shadow-md hover:shadow-lg submit-button-green",children:m?e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}):e.jsx("svg",{className:"w-5 h-5 sm:w-6 sm:h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 19l9 2-9-18-9 18 9-2zm0 0v-8"})})})]}),h&&e.jsxs("div",{className:"text-left text-sm sm:text-base text-white/80 bg-white/10 px-3 py-2 rounded-lg",children:[e.jsx("span",{className:"text-lg mr-2",children:h.icon}),h.statusMessage]})]})})})}),H=()=>{const{t:i}=k(),{toggleCardExpansion:c,isExpanded:b}=P(),[h,p]=s.useState([]),[m,T]=s.useState([]),[o,v]=s.useState([]),[N,w]=s.useState([]),[r,a]=s.useState(!1),[y,j]=s.useState(""),[l,C]=s.useState("thought");s.useEffect(()=>{const t=n.subscribeToThoughts(p),u=n.subscribeToTodos(T),g=n.subscribeToRadiologyNotes(v),f=n.subscribeToInvestments(w);return()=>{t(),u(),g(),f()}},[]);const E=s.useMemo(()=>{const t=h.map(d=>({...d,entryType:"thought"})),u=m.map(d=>({...d,entryType:"todo"})),g=o.map(d=>({...d,entryType:"radiology"})),f=N.map(d=>({...d,entryType:"investment"}));return[...t,...u,...g,...f].sort((d,D)=>new Date(D.createdAt).getTime()-new Date(d.createdAt).getTime()).slice(0,_.RECENT_ENTRIES_LIMIT)},[h,m,o,N]),I=t=>{switch(t.entryType){case"todo":return t.isCompleted?x.TODO_COMPLETED:x.TODO_PENDING;case"thought":return x.THOUGHT;case"radiology":return x.RADIOLOGY;case"investment":return x.INVESTMENT;default:return x.DEFAULT}},O=t=>{switch(t.entryType){case"todo":return i("type.todo");case"thought":return i("type.thought");case"radiology":return i("type.radiology");case"investment":return i("type.investment");default:return""}},R=async t=>{if(y)try{switch(t){case"thought":l!=="thought"&&await n.convertToThought(y,l);break;case"todo":l!=="todo"&&await n.convertToTodo(y,l);break;case"investment":l!=="investment"&&await n.convertToInvestment(y,l);break;case"radiology":l!=="radiology"&&await n.convertToRadiology(y,l);break}a(!1),j(""),C("thought")}catch(u){console.error("Failed to convert category:",u)}},A=t=>{j(t.id),C(t.entryType),a(!0)};return e.jsxs("div",{className:"max-w-7xl mx-auto px-0 sm:px-8 py-4 sm:py-8",children:[e.jsx(G,{}),E.length>0&&e.jsxs("div",{className:"px-4 sm:px-0",children:[e.jsxs("div",{className:"mb-6 sm:mb-8",children:[e.jsx("h3",{className:"text-xl sm:text-2xl font-bold text-gray-900 mb-2 tracking-tight",children:i("quick.recent")}),e.jsx("p",{className:"text-gray-500 text-base sm:text-lg font-medium",children:i("quick.recent_subtitle")})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-4 sm:gap-6",children:E.map(t=>{const u=q(t.content),g=b(t.id),f=u&&!g?F(t.content):t.content;return e.jsx("div",{className:"card card-hover",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("button",{onClick:()=>A(t),className:"badge hover:bg-blue-100 hover:border-blue-300 hover:text-blue-700 transition-colors cursor-pointer",title:"카테고리 변경",children:[I(t)," ",O(t)]}),e.jsx("span",{className:"badge",children:U(t.createdAt)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-base leading-relaxed text-primary font-medium whitespace-pre-line",children:f}),u&&e.jsx("button",{onClick:()=>c(t.id),className:M.EXPAND_BUTTON_CLASSES,children:g?"접기":"...더보기"})]})]})},t.id)})})]}),e.jsx(B,{isOpen:r,currentCategory:l,onCategorySelect:R,onClose:()=>{a(!1),j(""),C("thought")}})]})};export{H as QuickPage};
