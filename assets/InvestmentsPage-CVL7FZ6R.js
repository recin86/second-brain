import{u as I,a as T,r as i,d,j as e}from"./index-dgBwseAN.js";import{u as L,i as $,g as k,C as E,b as _}from"./CategoryChangeModal-CNBBTFve.js";import{u as M,a as F}from"./useLongPress-HVgbgiGk.js";const G=()=>{const{t:s}=I(),{showUndo:p}=T(),[h,g]=i.useState([]),[l,b]=i.useState(""),[f,v]=i.useState(!0),[j,o]=i.useState(!1),[m,c]=i.useState(""),{toggleCardExpansion:y,isExpanded:N}=L();i.useEffect(()=>{const t=d.subscribeToInvestments(r=>{g(r),v(!1)});return()=>t()},[]);const u=async(t,r=!1)=>{if(!(!r&&!window.confirm(s("investments.delete_confirm"))))try{const n=await d.softDeleteInvestment(t);p("투자 기록이 삭제되었습니다",n)}catch(n){console.error("Failed to delete investment:",n)}},w=async t=>{if(m)try{switch(t){case"thought":await d.convertToThought(m,"investment");break;case"todo":await d.convertToTodo(m,"investment");break;case"radiology":await d.convertToRadiology(m,"investment");break}o(!1),c("")}catch(r){console.error("Failed to convert category:",r)}},x=h.filter(t=>t.content.toLowerCase().includes(l.toLowerCase()));return f?e.jsx("div",{className:"container mx-auto px-8 py-12",children:e.jsx("div",{className:"flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-primary/20 rounded-2xl mx-auto mb-4 flex items-center justify-center animate-pulse",children:e.jsx("span",{className:"text-3xl",children:"💰"})}),e.jsx("p",{className:"text-muted",children:"Loading..."})]})})}):e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-8 py-6 sm:py-12",children:[e.jsx("div",{className:"mb-6 sm:mb-8",children:e.jsxs("div",{className:"bg-primary text-white rounded-xl sm:rounded-2xl p-4 sm:p-8 mb-6 sm:mb-8 shadow-lg",children:[e.jsxs("div",{className:"flex items-center mb-4 sm:mb-6",children:[e.jsx("div",{className:"w-10 h-10 sm:w-12 sm:h-12 bg-white/25 rounded-lg mr-3 sm:mr-4 flex items-center justify-center",children:e.jsx("span",{className:"text-xl sm:text-2xl",children:"💰"})}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("h2",{className:"text-xl sm:text-3xl font-bold tracking-tight truncate",children:s("investments.title")}),e.jsx("p",{className:"opacity-90 text-sm sm:text-lg",children:s("investments.subtitle")})]})]}),e.jsx("div",{className:"bg-white/95 rounded-xl sm:rounded-2xl p-4 sm:p-6 shadow-md",children:e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",value:l,onChange:t=>b(t.target.value),placeholder:s("investments.search"),className:"w-full px-4 py-3 text-base border-0 bg-transparent focus:outline-none placeholder-gray-400 text-primary"}),e.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:e.jsx("span",{className:"text-xl text-muted",children:"🔍"})})]})})]})}),e.jsx("div",{className:"flex items-center justify-between mb-6 sm:mb-8",children:e.jsx("h2",{className:"text-lg sm:text-2xl font-semibold",children:l?`검색 결과 (${x.length}${s("investments.count")})`:`전체 (${h.length}${s("investments.count")})`})}),x.length===0?e.jsxs("div",{className:"text-center py-12 sm:py-16",children:[e.jsx("div",{className:"w-16 h-16 sm:w-24 sm:h-24 bg-primary/10 rounded-2xl mx-auto mb-4 sm:mb-6 flex items-center justify-center",children:e.jsx("span",{className:"text-2xl sm:text-4xl",children:"💰"})}),e.jsx("h3",{className:"text-xl sm:text-2xl font-semibold mb-2 sm:mb-3",children:s(l?"search.no_results":"investments.empty_all")}),e.jsx("p",{className:"text-muted text-base sm:text-lg px-4",children:s(l?"search.no_results_subtitle":"investments.empty_subtitle")})]}):e.jsx("div",{className:"space-y-6",children:x.map(t=>{const r=$(t.content),n=N(t.id),C=r&&!n?k(t.content):t.content,S=()=>{const a=M({onSwipeLeft:()=>u(t.id,!0),onSwipeRight:()=>{c(t.id),o(!0)}},{threshold:100,preventScrollOnSwipe:!0}),D=F(()=>{c(t.id),o(!0)},{threshold:500});return e.jsxs("div",{className:`card card-hover relative group transform transition-transform duration-200 ${a.isDragging?a.swipeDirection==="left"?"bg-red-50 border-red-200":a.swipeDirection==="right"?"bg-blue-50 border-blue-200":"":""}`,style:{transform:a.isDragging?`translateX(${Math.min(Math.max(a.getSwipeDistance(),-150),150)}px)`:"translateX(0)"},...a.swipeHandlers,...D.handlers,children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("button",{onClick:()=>{c(t.id),o(!0)},className:"badge hover:bg-blue-100 hover:border-blue-300 hover:text-blue-700 transition-colors cursor-pointer",title:"카테고리 변경",children:"💰 투자"}),e.jsx("div",{className:"badge",children:_(t.createdAt)})]}),e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1 pr-8",children:[e.jsx("p",{className:"text-base leading-relaxed font-medium text-primary whitespace-pre-line",children:C}),r&&e.jsx("button",{onClick:()=>y(t.id),className:"mt-2 text-sm text-blue-600 hover:text-blue-800 font-medium transition-colors",children:n?"접기":"...더보기"})]}),e.jsx("button",{onClick:()=>u(t.id),className:"absolute top-4 right-4 opacity-100 sm:opacity-0 sm:group-hover:opacity-100 transition-opacity duration-200 text-muted hover:text-red-600 p-1 z-20","aria-label":"Delete investment",children:"🗑️"})]})]}),a.isDragging&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:`absolute left-4 top-1/2 transform -translate-y-1/2 text-2xl transition-opacity ${a.swipeDirection==="right"?"opacity-100":"opacity-30"}`,children:"🔄"}),e.jsx("div",{className:`absolute right-4 top-1/2 transform -translate-y-1/2 text-2xl transition-opacity ${a.swipeDirection==="left"?"opacity-100":"opacity-30"}`,children:"🗑️"})]})]},t.id)};return e.jsx(S,{},t.id)})}),e.jsx(E,{isOpen:j,currentCategory:"investment",onCategorySelect:w,onClose:()=>{o(!1),c("")}})]})};export{G as InvestmentsPage};
