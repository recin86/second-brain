import{u as D,r as d,d as a,j as t}from"./index-DEemqsSM.js";import{u as E,i as $,g as A,b as h}from"./useCardExpansion-CPBgE9c9.js";function S(s,l){let o;return function(...n){const c=this,m=()=>{o=null,s.apply(c,n)};o&&clearTimeout(o),o=setTimeout(m,l)}}const B=()=>{const{t:s}=D(),[l,o]=d.useState([]),[n,c]=d.useState("all"),{toggleCardExpansion:m,isExpanded:g}=E();d.useEffect(()=>{const e=a.subscribeToTodos(o);return()=>e()},[]);const b=e=>{const r=l.find(i=>i.id===e);r&&a.updateTodo(e,{isCompleted:!r.isCompleted})},f=d.useRef(S((e,r)=>{a.updateTodo(e,r)},500)),y=(e,r)=>{const i=r.target.value?new Date(r.target.value):void 0;f.current(e,{dueDate:i})},j=(e,r)=>{const i=["low","medium","high"],u=(i.indexOf(r)+1)%i.length;a.updateTodo(e,{priority:i[u]})},v=e=>{window.confirm(s("todos.delete_confirm"))&&a.deleteTodo(e)},x=l.filter(e=>n==="pending"?!e.isCompleted:n==="completed"?e.isCompleted:!0),w=[...x].sort((e,r)=>e.isCompleted===r.isCompleted?r.createdAt.getTime()-e.createdAt.getTime():e.isCompleted?1:-1),C=l.filter(e=>!e.isCompleted).length,N=l.filter(e=>e.isCompleted).length,T=e=>{switch(e){case"high":return"bg-red-600 hover:bg-red-700 text-white border-red-700";case"medium":return"btn-secondary";case"low":return"btn-accent";default:return"text-date"}},k=e=>{switch(e){case"high":return s("todos.priority.high");case"medium":return s("todos.priority.medium");case"low":return s("todos.priority.low");default:return s("todos.priority.medium")}};return t.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-8 py-6 sm:py-12",children:[t.jsx("div",{className:"mb-6 sm:mb-8",children:t.jsxs("div",{className:"bg-primary text-white rounded-xl sm:rounded-2xl p-4 sm:p-8 mb-6 sm:mb-8 shadow-lg",children:[t.jsxs("div",{className:"flex items-center mb-4 sm:mb-6",children:[t.jsx("div",{className:"w-10 h-10 sm:w-12 sm:h-12 bg-white/25 rounded-lg mr-3 sm:mr-4 flex items-center justify-center",children:t.jsx("span",{className:"text-xl sm:text-2xl",children:"✅"})}),t.jsxs("div",{className:"min-w-0",children:[t.jsx("h2",{className:"text-xl sm:text-3xl font-bold tracking-tight truncate",children:s("todos.title")}),t.jsx("p",{className:"opacity-90 text-sm sm:text-lg",children:s("todos.subtitle")})]})]}),t.jsx("div",{className:"bg-white/95 rounded-xl sm:rounded-2xl p-4 sm:p-6 shadow-md",children:t.jsx("div",{className:"flex space-x-2 sm:space-x-3 overflow-x-auto",children:[{key:"all",label:s("todos.all"),count:l.length},{key:"pending",label:s("todos.pending"),count:C},{key:"completed",label:s("todos.completed"),count:N}].map(e=>t.jsxs("button",{onClick:()=>c(e.key),className:`px-3 py-2 sm:px-4 sm:py-2 rounded-lg font-semibold transition-all duration-200 whitespace-nowrap text-sm sm:text-base ${n===e.key?"bg-primary text-white shadow-md":"text-primary hover:text-primary/80 bg-transparent hover:bg-primary/10"}`,children:[e.label," (",e.count,")"]},e.key))})})]})}),x.length===0?t.jsxs("div",{className:"card text-center",children:[t.jsx("h3",{className:"text-xl font-bold text-primary mb-3",children:s(n==="completed"?"todos.empty_completed":n==="pending"?"todos.empty_pending":"todos.empty_all")}),t.jsx("p",{className:"text-muted text-base",children:s("todos.empty_subtitle")})]}):t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:w.map(e=>{const r=$(e.content),i=g(e.id),p=r&&!i?A(e.content):e.content;return t.jsxs("div",{className:`card card-hover relative group ${e.isCompleted?"opacity-60":""}`,children:[t.jsx("button",{onClick:()=>v(e.id),className:"text-muted hover:text-red-600 absolute top-4 right-4 opacity-0 group-hover:opacity-100 transition-opacity duration-200 z-10","aria-label":"Delete todo",children:"🗑️"}),t.jsxs("div",{className:"flex items-start space-x-4 h-full",children:[t.jsx("button",{onClick:()=>b(e.id),className:`flex-shrink-0 w-7 h-7 rounded-2xl border-2 flex items-center justify-center transition-all mt-1 ${e.isCompleted?"shadow-md":"hover:bg-opacity-10"}`,style:e.isCompleted?{backgroundColor:"#8ABF92",borderColor:"#8ABF92",color:"#038C3E"}:{borderColor:"#8ABF92",backgroundColor:"transparent",color:"#8ABF92"},children:e.isCompleted&&t.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:t.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})}),t.jsxs("div",{className:"flex-1 min-w-0 flex flex-col justify-between h-full",children:[t.jsxs("div",{children:[t.jsx("p",{className:`text-base font-semibold leading-relaxed mb-3 pr-8 whitespace-pre-line ${e.isCompleted?"line-through text-muted":"text-primary"}`,children:p}),r&&t.jsx("button",{onClick:()=>m(e.id),className:"mb-3 text-sm text-blue-600 hover:text-blue-800 font-medium transition-colors",children:i?"접기":"...더보기"})]}),t.jsxs("div",{className:"flex flex-col mt-auto pt-2",children:[t.jsx("div",{className:"flex items-center justify-between",children:!e.isCompleted&&t.jsxs("label",{className:"relative inline-flex items-center cursor-pointer ml-auto",children:[t.jsx("input",{type:"date",value:e.dueDate?e.dueDate.toISOString().split("T")[0]:"",onChange:u=>y(e.id,u),className:"absolute opacity-0 w-0 h-0","aria-label":e.dueDate?s("todos.due"):s("todos.add_due")}),t.jsx("span",{className:`font-bold px-3 py-1 rounded-xl text-xs flex items-center transition-colors duration-200 cursor-pointer ${e.dueDate?"btn-primary":"text-date hover:bg-green-50"}`,children:e.dueDate?`${s("todos.due")}: ${h(e.dueDate,{year:"numeric",month:"short",day:"numeric"})}`:s("todos.add_due")})]})}),t.jsxs("div",{className:"flex items-center justify-between mt-2",children:[t.jsx("button",{onClick:()=>j(e.id,e.priority),className:`btn px-3 py-1 text-xs ${T(e.priority)}`,"aria-label":"Priority change",children:k(e.priority)}),t.jsx("span",{className:"badge",children:h(e.createdAt)})]})]})]})]})]},e.id)})})]})};export{B as TodosPage};
